syntax = "proto3";
package tracker;

message InitRequest {
    required string email = 1;
    required string daemon_name = 2;
}

message InitResponse {
    enum Result {
        ACCEPTED = 0;
        REJECTED = 1;
    }
    required Result response = 1;
}

message ConfirmRequest {
    required string token = 1;
}

message ConfirmResponse {
    enum Result {
        ACCEPTED = 0;
        REJECTED = 1;
    }
    required Result response = 1;
    optional string token = 2;
}

message CreateRequest {
    enum Type {
        SERVER = 0;
        CLIENT = 1;
    }
    required string token = 1;
    required string path = 2;
    required Type type = 3;
    required string connect_address = 4;
    required string connect_port = 5;
    required string listen_address = 6;
    required string listen_port = 7;
}

message CreateResponse {
    enum Result {
        ACCEPTED = 0;
        REJECTED = 1;
        INVALID_PATH = 2;
        PATH_EXISTS = 3;
    }
    required Result response = 1;
    optional string server_token = 2;
    optional string client_token = 3;
}

message ClientMessage {
    enum Type {
        INIT_REQUEST = 0;
        CONFIRM_REQUEST = 1;
        CREATE_REQUEST = 2;
        ALIVE = 99;
    }
    required Type type = 1;
    optional string message_id = 2;
    optional InitRequest init_request = 3;
    optional ConfirmRequest confirm_request = 4;
    optional CreateRequest create_request = 5;
}

message ServerMessage {
    enum Type {
        INIT_RESPONSE = 0;
        CONFIRM_RESPONSE = 1;
        CREATE_RESPONSE = 2;
        ALIVE = 99;
    }
    required Type type = 1;
    optional string message_id = 2;
    optional InitResponse init_response = 3;
    optional ConfirmResponse confirm_response = 4;
    optional CreateResponse create_response = 5;
}